> 源码解析参考[yii深入理解](http://www.digpage.com/route.html)  
> 路由的使用参考[urlManager参数详解](http://blog.csdn.net/u013732204/article/details/53266701)

## urlManager 配置
```php
[
    'components' => [
        'urlManager' => [
            'enablePrettyUrl' => true,// 开启 url美化
            'showScriptName' => false,//隐藏入口文件 index.php
            'enableStrictParsing' => false,//true严格按照rules匹配，也就是必须匹配定义的rules才能解释，正常默认是的失效
            'suffix' => '.html',// 后缀
            'rules' => [
                // ...
            ],
        ],
    ],
]
```
## rules 设置  

### 直接映射
```php
['index' => 'ding/bunao']
```
> 当访问 `/index` 时实际访问的是 `/ding/bunao`

### 左边正则匹配型
```php
['test/<id:\d+>' => 'test/bunao']
```
> 当访问 `/test/10` 的时候实际访问的是 `/test/bunao?id=10`    

```php
[test/<year:\d{4}>/<category>' => 'test/bunao'],
```
> 当访问 `/test/1000/ding` 的时候实际访问的是 `/test/bunao?year=1000&category=ding`  

```php
[test-<year:\d{4}>' => 'test/bunao'],
```  
> 当访问 `/test-1000` 的时候实际访问的是 `/test/bunao?year=1000`

### 两边匹配  
```php
['<ding:(test|comment)>/<id:\d+>/<bunao:(bunao|update|delete)>' => '<ding>/<bunao>']
```
> 当访问 `/test/100/bunao` 的时候实际访问的是 `/test/bunao?id=100`  

**通常会写成下面的形式，方便阅读**
```php
['<controller:(test|comment)>/<id:\d+>/<action:(bunao|update|delete)>' => '<controller>/<action>']
```

其他实例
```php
 ['<controller:(post|comment)>/<id:\d+>' => '<controller>/view']
```
> 当访问 `/post/100` 的时候实际访问的是 `/post/view?id=100`

### 带有默认值的
```php
[
    [
        'pattern' => 'posts/<page:\d+>/<tag>',// 请求部分
        'route' => 'post/index',// 解析部分
        'defaults' => ['page' => 1, 'tag' => ''],// 默认值
    ],
]
```
> 当请求 `/posts` 时实际请求的是 `/post/index?page=1&tag=''`  

### 限制请求方式的  
```php
['POST post/<id:\d+>' => 'post/create']
```
> 表示请求 `/post/100` 如果要访问到 `/post/create?id=100` 必须是 `POST` 请求  

```php
['POST,PUT post/<id:\d+>' => 'post/create']
```
> 表示允许 `post` 和 `pub` 方式请求。多个用 `,` 隔开  

### 域名匹配  
> 一个项目配置了好几个域名，根据域名来控制访问，比如说pc、mobile、api三个用不同的域名  

```php
[
    'http://<language:\w+>.example.com/posts' => 'post/index',
    'http://admin.example.com/login' => 'admin/user/login',
    'http://www.example.com/login' => 'site/login',
]
```  
> 用不同的域名访问请求

### 自定义URLRule
还没用过  

### 总结

1. 如果左边有 `<>` 而右边没有对应的，则 `<>` 中定义的匹配到的作为 `$_GET` 的一组值。
2. 如果右边有和左边对应的(值相等的) `<>` ，表示左边匹配到的替换到右边就行了
3. `<>` 中的 `:\xx` 定义的是正则匹配的规则，如：`:\d+` 匹配任意个数字， `:\d{4}` 只能匹配4位的数值, `:(test|comment)` 只能匹配 test 或 comment 中的其中一个  

## 支持驼峰形式请求  
### 部分支持驼峰形式请求  
> 参考 [Yii2使用驼峰命名的形式访问控制器](http://www.yiichina.com/topic/7266)  

```php
namespace common\components;
use \yii\web\Controller;//使用web
use yii\base\InlineAction;

class zController extends Controller
{
    /**
     * Author:Steven 原作者
     * Desc:重写路由，处理访问控制器支持驼峰命名法
     * @param string $id
     * @return null|object|InlineAction
     */
    public function createAction($id)
    {
        if ($id === '') {
            $id = $this->defaultAction;
        }

        $actionMap = $this->actions();
        if (isset($actionMap[$id])) {
            return \Yii::createObject($actionMap[$id], [$id, $this]);
        } elseif (preg_match('/^[a-z0-9\\-_]+$/', $id) && strpos($id, '--') === false && trim($id, '-') === $id) {
            $methodName = 'action' . str_replace(' ', '', ucwords(implode(' ', explode('-', $id))));
            if (method_exists($this, $methodName)) {
                $method = new \ReflectionMethod($this, $methodName);
                if ($method->isPublic() && $method->getName() === $methodName) {
                    return new InlineAction($id, $this, $methodName);
                }
            }
            // 驼峰形式,支持第一个字母小写
            } else {
            	$id = ucfirst($id);
                $methodName = 'action' . $id;
                if (method_exists($this, $methodName)) {
                    $method = new \ReflectionMethod($this, $methodName);
                    if ($method->isPublic() && $method->getName() === $methodName) {
                        return new InlineAction($id, $this, $methodName);
                    }
                }
            }
        return null;
    }
}
```
需要驼峰的控制器继承此类就行了
